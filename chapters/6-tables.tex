\section{Tables}

\newcommand{\ci}[1]{{\small (#1)}}  % CI range for the AUCs.

\begin{algorithm}[ht]
  \caption{LPOCV with inner feature selection by AUC filtering and
  hyperparameter selection.}\label{alg:pseudocode}

  \begin{algorithmic}
    \REQUIRE{$\vec{X}$, matrix of $n$ lesions × $F$ features}
    \REQUIRE{$\vec{y}$, vector of labels (1 high, -1 low)}
    \REQUIRE{$\omega = \{0.001, 0.01, 0.1, 1, 10\}$, set of hyperparameters}
    \ENSURE{LPOCV scores}
    \FOR[All possible lesion pairs]{$i, j \in \{1,2,\dotsc,n\}$}
      \STATE{$C \gets \{1,2,\dotsc,n\} \setminus \{i,j\}$} \COMMENT{All lesions except $i,j$}
      \STATE{$\vec{auc} \gets$ vector of length $F$}
      \FOR{$k \in \{1,2,\dotsc,F\}$}
        \STATE{$\vec{auc}[k] \gets \mathrm{AUC}(\vec{X}[C,k], \vec{y}[C])$}  \COMMENT{Calculate AUC for each feature}
        \STATE{$\vec{auc}[k] \gets \max(\vec{auc}[k], 1-\vec{auc}[k])$}  \COMMENT{Handle inverse correlation}
      \ENDFOR{}
    \STATE{$\indx \gets \arg\mathrm{sort}(\vec{auc})[1 \dotso (0.01 \times F)]$}  \COMMENT{Get indices of the best features}
    \STATE{$\alpha \gets \mathrm{gridSearch}(\vec{y}[C], \vec{X}[C,\indx], \omega)$}  \COMMENT{Grid search with 10FCV, returns the best hyperparameter}
    \STATE{$f \gets A(\vec{y}[C], \vec{X}[C,\indx], \alpha)$}  \COMMENT{Train model f with algorithm A and hyperparameter $\alpha$}
    \STATE{$\vec{W}_{ij} \gets H(f(\vec{X}[i,\indx]) - f(\vec{X}[j,\indx]))$}  \COMMENT{Matrix W stores results from Heaviside function (H) of i and j prediction difference}
    \ENDFOR{}
    \STATE{$\tilde{\vec{y}} \gets \vec{W} \textbf{1}$}  \COMMENT{Score of each element obtained by summing along axis j}
    \RETURN{$\tilde{\vec{y}}$}  \COMMENT{Returns LPOCV scores}
  \end{algorithmic}
\end{algorithm}


\begin{table}[ht]
  \caption{Texture methods ranked in the best one percent.}
  \label{tab:texture_best1p}

  \begin{tabular}{c c c c}
  \hline
  Image type & Window sizes & Texture extraction methods & AUC range \\
  \hline
  T₂w & 27 & MBB-GLCM, GLCM, Gabor & 0.71--0.84 \\
  ADCₘ & 11 & Gabor & 0.79--0.80 \\
  ADCₖ & 11 & Gabor & 0.79--0.80 \\
  K & 7, 9 & Zernike, Gabor & 0.78--0.83 \\
  T₂ & 15, 19, 27, 31, 35 & Zernike, Hu, MBB-GLCM, LBP, GLCM, Gabor & 0.71--0.75 \\
  \hline
  \end{tabular}
\end{table}


\begin{table}[ht]
  \caption{Best texture feature per image type.}
  \label{tab:texture_imagetype}

  \begin{tabular}{c c c c}
  \hline
  Image type & Window sizes & Type of Texture feature & AUC \\
  \hline
  T₂w & NA & MBB-GLCM\@: homogeneity, $d$=3, range & 0.84 \\
  ADCₘ & 11 & Gabor: $\sigma$=1, $f$=0.3, mean & 0.80 \\
  ADCₖ & 11 & Gabor: $\sigma$=2, $f$=0.1, mean & 0.80 \\
  K & 7 & Zernike: index=7 & 0.83 \\
  T₂ & 35 & Zernike: index=3 & 0.75 \\
  \hline
  \end{tabular}
\end{table}


\begin{table}[ht]
  \caption{Best statistical feature per image type.}
  \label{tab:stats_imagetype}

  \begin{tabular}{c c c}
  \hline
  Image type & Statistical feature & AUC \\
  \hline
  T₂w & Minimum & 0.72 \\
  ADCₘ & Minimum & 0.79 \\
  ADCₖ & Minimum & 0.79 \\
  K & Range & 0.78 \\
  T₂ & 20th percentile & 0.55 \\
  \hline
  \end{tabular}
\end{table}

\begin{table}[ht]
  \caption{Area under the receiver operating curve values estimated using outer
  leave-pair-out cross-validation (LPOCV) per image type with all features, top
  1\% features filtered by AUC, and the 18 statistical features.}
  \label{tab:auc_imagetype}

  %\begin{tabular}{p{3em} p{5.2em} | p{3em} p{7.2em} | p{5.7em} p{7.2em} | p{7.2em}}
  \begin{tabular}{c c  c c  c c  c}
  \hline
  & & \multicolumn{2}{c}{All features} & \multicolumn{2}{c}{Top 1\% features} & 18 statistical \\
  Image type & ML algorithm & N & AUC \ci{95\%~CI} & N & AUC \ci{95\%~CI} & AUC \ci{95\%~CI} \\
  \hline
  T₂w  & Log. Reg. L1 & 1631 & 0.82 \ci{0.72--0.92} & 16 & 0.80 \ci{0.69--0.90} & 0.67 \ci{0.56--0.77} \\
       & Log. Reg. L2 &      & 0.68 \ci{0.55--0.82} &    & 0.75 \ci{0.64--0.87} & 0.71 \ci{0.60--0.81} \\
  ADCₘ & Log. Reg. L1 & 1281 & 0.67 \ci{0.55--0.79} & 12 & 0.71 \ci{0.60--0.82} & 0.79 \ci{0.68--0.90} \\
       & Log. Reg. L2 &      & 0.69 \ci{0.57--0.81} &    & 0.75 \ci{0.65--0.86} & 0.75 \ci{0.63--0.86} \\
  ADCₖ & Log. Reg. L1 & 1281 & 0.71 \ci{0.58--0.83} & 12 & 0.74 \ci{0.63--0.84} & 0.78 \ci{0.69--0.88} \\
       & Log. Reg. L2 &      & 0.73 \ci{0.63--0.83} &    & 0.76 \ci{0.65--0.86} & 0.73 \ci{0.61--0.84} \\
  K    & Log. Reg. L1 & 1281 & 0.64 \ci{0.52--0.77} & 12 & 0.78 \ci{0.67--0.89} & 0.75 \ci{0.61--0.88} \\
       & Log. Reg. L2 &      & 0.73 \ci{0.60--0.85} &    & 0.76 \ci{0.64--0.87} & 0.73 \ci{0.60--0.86} \\
  T₂   & Log. Reg. L1 & 1631 & 0.58 \ci{0.45--0.71} & 16 & 0.51 \ci{0.37--0.65} & 0.67 \ci{0.55--0.79} \\
       & Log. Reg. L2 &      & 0.70 \ci{0.59--0.82} &    & 0.56 \ci{0.43--0.69} & 0.56 \ci{0.43--0.68} \\
  \hline
  \end{tabular}
\end{table}


\begin{table}[ht]
  \caption{Area under the receiver operating curve values estimated using outer
  leave-pair-out cross-validation (LPOCV) for the combinations of the image
  types.}
  \label{tab:auc_combinations}

  %\begin{tabular}{l p{5.2em} p{3em} p{7.2em} p{5.7em} p{7.2em}}
  \begin{tabular}{c c  c c  c c}
  \hline
  & & \multicolumn{2}{c}{All features} & \multicolumn{2}{c}{Top 1\% features} \\
  Image types & ML algorithm & N & AUC \ci{95\%~CI} & N & AUC \ci{95\%~CI} \\
  \hline
  ADCₖ, K                & Log. Reg. L1 & 2562 & 0.61 \ci{0.49--0.74} & 25 & 0.82 \ci{0.72--0.92} \\
                         & Log. Reg. L2 &      & 0.72 \ci{0.60--0.83} &    & 0.81 \ci{0.70--0.91} \\
  ADCₘ, K                & Log. Reg. L1 & 2562 & 0.57 \ci{0.45--0.70} & 25 & 0.81 \ci{0.71--0.91} \\
                         & Log. Reg. L2 &      & 0.72 \ci{0.60--0.84} &    & 0.79 \ci{0.68--0.89} \\
  ADCₘ, ADCₖ, K          & Log. Reg. L1 & 3843 & 0.58 \ci{0.44--0.72} & 38 & 0.83 \ci{0.74--0.92} \\
                         & Log. Reg. L2 &      & 0.69 \ci{0.56--0.81} &    & 0.79 \ci{0.70--0.88} \\
  ADCₘ, ADCₖ, K, T₂      & Log. Reg. L1 & 5474 & 0.61 \ci{0.47--0.74} & 54 & 0.84 \ci{0.75--0.92} \\
                         & Log. Reg. L2 &      & 0.77 \ci{0.66--0.87} &    & 0.79 \ci{0.70--0.88} \\
  ADCₘ, ADCₖ, K, T₂w     & Log. Reg. L1 & 5474 & 0.78 \ci{0.68--0.89} & 54 & 0.88 \ci{0.81--0.95} \\
                         & Log. Reg. L2 &      & 0.70 \ci{0.58--0.82} &    & 0.86 \ci{0.78--0.93} \\
  ADCₘ, ADCₖ, K, T₂, T₂w & Log. Reg. L1 & 7105 & 0.74 \ci{0.62--0.86} & 71 & 0.88 \ci{0.81--0.95} \\
                         & Log. Reg. L2 &      & 0.79 \ci{0.69--0.90} &    & 0.86 \ci{0.78--0.93} \\
  ADCₘ, K, T₂            & Log. Reg. L1 & 4193 & 0.69 \ci{0.56--0.82} & 41 & 0.83 \ci{0.74--0.91} \\
                         & Log. Reg. L2 &      & 0.78 \ci{0.68--0.88} &    & 0.82 \ci{0.73--0.90} \\
  ADCₘ, K, T₂w           & Log. Reg. L1 & 4193 & 0.81 \ci{0.71--0.91} & 41 & 0.88 \ci{0.82--0.95} \\
                         & Log. Reg. L2 &      & 0.70 \ci{0.59--0.82} &    & 0.86 \ci{0.79--0.93} \\
  ADCₘ, K, T₂, T₂w       & Log. Reg. L1 & 5824 & 0.76 \ci{0.65--0.87} & 58 & 0.87 \ci{0.81--0.94} \\
                         & Log. Reg. L2 &      & 0.79 \ci{0.68--0.89} &    & 0.85 \ci{0.77--0.92} \\
  ADCₖ, K, T₂            & Log. Reg. L1 & 4193 & 0.53 \ci{0.40--0.66} & 41 & 0.81 \ci{0.72--0.91} \\
                         & Log. Reg. L2 &      & 0.80 \ci{0.71--0.89} &    & 0.81 \ci{0.71--0.91} \\
  ADCₖ, K, T₂w           & Log. Reg. L1 & 4193 & 0.81 \ci{0.72--0.91} & 41 & 0.85 \ci{0.77--0.93} \\
                         & Log. Reg. L2 &      & 0.72 \ci{0.61--0.84} &    & 0.84 \ci{0.76--0.92} \\
  T₂, T₂w                & Log. Reg. L1 & 3262 & 0.82 \ci{0.73--0.91} & 32 & 0.66 \ci{0.52--0.79} \\
                         & Log. Reg. L2 &      & 0.78 \ci{0.68--0.88} &    & 0.61 \ci{0.48--0.74} \\
  \hline
  \end{tabular}
\end{table}
